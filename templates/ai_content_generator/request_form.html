{% extends 'dashboard/teacher/base.html' %}
{% load static %}

{% block title %}Solicitud de Contenido{% endblock %}

{% block teacher_content %}
<div class="content-container">
    <!-- Mensajes flotantes -->
    {% include 'partials/_messages.html' %}

    <!-- Breadcrumb Navigation -->
    <nav class="dashboard-breadcrumb" aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item">
                <a href="{% url 'dashboard:teacher' %}" class="breadcrumb-link">
                    <i class="fas fa-home"></i>
                    <span>Dashboard</span>
                </a>
            </li>
            {% if from_course_dashboard and course_topic %}
                <li class="breadcrumb-item">
                    <a href="{% url 'dashboard:teacher_sections' %}" class="breadcrumb-link">
                        <i class="fas fa-users"></i>
                        <span>Mis Secciones</span>
                    </a>
                </li>
                <li class="breadcrumb-item">
                    <a href="{% url 'dashboard:teacher_section_detail' section.id %}" class="breadcrumb-link">
                        <i class="fas fa-door-open"></i>
                        <span>{{ section.grade.name }} - Sección {{ section.name }}</span>
                    </a>
                </li>
                <li class="breadcrumb-item">
                    <a href="{% url 'dashboard:course_topic_detail' pk=course_topic.id %}" class="breadcrumb-link">
                        <i class="fas fa-book-open"></i>
                        <span>{{ course_topic.title }}</span>
                    </a>
                </li>
            {% else %}
                <li class="breadcrumb-item">
                    <a href="{% url 'ai:content_request_list' %}" class="breadcrumb-link">
                        <i class="fas fa-robot"></i>
                        <span>Contenido IA</span>
                    </a>
                </li>
            {% endif %}
            <li class="breadcrumb-item active" aria-current="page">
                <i class="fas fa-magic"></i>
                <span>Generar Contenido</span>
            </li>
        </ol>
    </nav>

    <div class="container py-4">
        <!-- Formulario Principal Mejorado -->
        <div class="modern-form-container">
            <div class="form-header">
                {% if from_course_dashboard and course_topic %}
                    <div class="header-icon">
                        <i class="fas fa-magic"></i>
                    </div>
                    <div class="header-content">
                        <h3 class="header-title">Generar Material Educativo</h3>
                        <p class="header-subtitle">Crea contenido personalizado con inteligencia artificial</p>
                    </div>
                {% else %}
                    <div class="header-icon">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="header-content">
                        <h3 class="header-title">Asistente de Creación de Contenido</h3>
                        <p class="header-subtitle">Genera material educativo de forma inteligente</p>
                    </div>
                {% endif %}
            </div>
            
            <div class="form-body">
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    
                    {% if form.errors %}
                    <div class="alert alert-danger">
                        <h5><i class="fas fa-exclamation-triangle me-2"></i> Por favor corrige los siguientes errores:</h5>
                        <ul class="mb-0">
                            {% for field in form %}
                                {% for error in field.errors %}
                                    <li>{{ field.label }}: {{ error }}</li>
                                {% endfor %}
                            {% endfor %}
                            {% for error in form.non_field_errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endif %}
                    
                    {% if from_course_dashboard and course_topic %}
                        <!-- Información del curso y tema -->
                        <div class="alert alert-info mb-4">
                            <h6 class="mb-2">
                                <i class="fas fa-info-circle me-2"></i>
                                Generando contenido para: {{ course_topic.course.name }} - {{ course_topic.title }}
                            </h6>
                            <small class="text-muted">
                                {{ section.grade.name }} - Sección {{ section.name }} ({{ students_count }} estudiantes)
                            </small>
                        </div>
                    {% endif %}

                    <!-- Campos ocultos para datos automáticos -->
                    {% if from_course_dashboard and course_topic %}
                        <input type="hidden" name="course_topic" value="{{ course_topic.id }}">
                        <input type="hidden" name="course" value="{{ course_topic.course.id }}">
                        <input type="hidden" name="topic" value="{{ course_topic.title }}">
                        <input type="hidden" name="grade_level" value="{{ section.grade.name }}">
                        <input type="hidden" name="section" value="{{ section.id }}">
                        <input type="hidden" name="for_class" value="true">
                    {% else %}
                        <!-- Campos manuales cuando no viene del dashboard del curso -->
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <label for="{{ form.course.id_for_label }}" class="form-label">
                                    <i class="fas fa-graduation-cap me-2"></i>Curso
                                </label>
                                {{ form.course }}
                            </div>
                            <div class="col-md-6">
                                <label for="{{ form.topic.id_for_label }}" class="form-label">
                                    <i class="fas fa-bookmark me-2"></i>Tema
                                </label>
                                {{ form.topic }}
                            </div>
                        </div>
                        
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <label for="{{ form.grade_level.id_for_label }}" class="form-label">
                                    <i class="fas fa-layer-group me-2"></i>Nivel de Grado
                                </label>
                                {{ form.grade_level }}
                            </div>
                            <div class="col-md-6">
                                <label for="{{ form.section.id_for_label }}" class="form-label">
                                    <i class="fas fa-door-open me-2"></i>Sección
                                </label>
                                {{ form.section }}
                            </div>
                        </div>
                    {% endif %}

                    <!-- Selección de Tipo de Contenido -->
                    <div class="form-section mb-4">
                        <h5 class="section-title">
                            <i class="fas fa-palette me-2"></i>
                            Tipo de Contenido
                        </h5>
                        <p class="section-description">Selecciona el tipo de material educativo que deseas generar</p>
                        
                        <div class="content-type-grid">
                            <div class="content-type-card" data-value="1">
                                <div class="card-icon">
                                    <i class="fas fa-chalkboard-teacher"></i>
                                </div>
                                <div class="card-content">
                                    <h6 class="card-title">Explicación de tema</h6>
                                    <p class="card-description">Contenido estructurado para enseñar conceptos</p>
                                </div>
                            </div>
                            
                            <div class="content-type-card" data-value="2">
                                <div class="card-icon">
                                    <i class="fas fa-pencil-alt"></i>
                                </div>
                                <div class="card-content">
                                    <h6 class="card-title">Ejercicios prácticos</h6>
                                    <p class="card-description">Actividades prácticas y problemas</p>
                                </div>
                            </div>
                            
                            <div class="content-type-card" data-value="3">
                                <div class="card-icon">
                                    <i class="fas fa-question-circle"></i>
                                </div>
                                <div class="card-content">
                                    <h6 class="card-title">Evaluación</h6>
                                    <p class="card-description">Evaluaciones y preguntas interactivas</p>
                                </div>
                            </div>
                            
                            <div class="content-type-card selected" data-value="4">
                                <div class="card-icon">
                                    <i class="fas fa-book"></i>
                                </div>
                                <div class="card-content">
                                    <h6 class="card-title">Material didáctico</h6>
                                    <p class="card-description">Material educativo completo</p>
                                </div>
                            </div>
                            
                            <div class="content-type-card" data-value="5">
                                <div class="card-icon">
                                    <i class="fas fa-list-ul"></i>
                                </div>
                                <div class="card-content">
                                    <h6 class="card-title">Resumen</h6>
                                    <p class="card-description">Síntesis de conceptos clave</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Input oculto para el tipo de contenido -->
                        <input type="hidden" id="id_content_type" name="content_type" value="{{ form.content_type.value|default:'4' }}">
                    </div>

                    <!-- Carga de Archivos -->
                    <div class="form-section mb-4">
                        <h5 class="section-title">
                            <i class="fas fa-file-upload me-2"></i>
                            Material de Referencia (Opcional)
                        </h5>
                        <p class="section-description">Sube un archivo PDF para que la IA lo use como referencia</p>
                        
                        <div class="upload-area" id="upload-area">
                            <div class="upload-icon">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <div class="upload-content">
                                <h6 class="upload-title">Arrastra tu archivo PDF aquí</h6>
                                <p class="upload-subtitle">o haz clic para seleccionar</p>
                                <small class="upload-note">Máximo 10MB • Solo archivos PDF</small>
                            </div>
                            <input type="file" class="upload-input" name="pdf_file" accept=".pdf" style="display: none;">
                        </div>
                    </div>

                    <!-- Instrucciones Específicas -->
                    <div class="form-section mb-4">
                        <h5 class="section-title">
                            <i class="fas fa-edit me-2"></i>
                            Instrucciones Específicas
                        </h5>
                        <p class="section-description">Proporciona detalles adicionales sobre lo que necesitas</p>
                        
                        <div class="instructions-container">
                            <textarea 
                                class="instructions-textarea" 
                                name="additional_instructions" 
                                placeholder="Describe qué tipo de contenido necesitas, el enfoque pedagógico, nivel de dificultad, o cualquier requerimiento específico..."
                                maxlength="1000"
                            >{{ form.additional_instructions.value|default:'' }}</textarea>
                            <div class="char-counter">
                                <span id="char-count">0</span>/1000 caracteres
                            </div>
                        </div>
                        
                        <!-- Sugerencias rápidas -->
                        <div class="suggestions-section mt-3">
                            <h6 class="suggestions-title">Sugerencias rápidas:</h6>
                            <div class="suggestions-tags">
                                <span class="suggestion-tag" data-text="Incluye ejemplos prácticos y ejercicios resueltos">
                                    <i class="fas fa-lightbulb me-1"></i>
                                    Ejemplos prácticos
                                </span>
                                <span class="suggestion-tag" data-text="Adapta el contenido para estudiantes con diferentes estilos de aprendizaje">
                                    <i class="fas fa-users me-1"></i>
                                    Estilos de aprendizaje
                                </span>
                                <span class="suggestion-tag" data-text="Incluye actividades interactivas y dinámicas grupales">
                                    <i class="fas fa-hands-helping me-1"></i>
                                    Actividades grupales
                                </span>
                                <span class="suggestion-tag" data-text="Proporciona material de refuerzo para estudiantes con dificultades">
                                    <i class="fas fa-heart me-1"></i>
                                    Material de refuerzo
                                </span>
                                <span class="suggestion-tag" data-text="Incluye evaluación formativa y rúbricas de calificación">
                                    <i class="fas fa-clipboard-check me-1"></i>
                                    Evaluación formativa
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- Botón de Generación -->
                    <div class="form-actions">
                        <button type="submit" class="generate-btn" id="generate-btn">
                            <span class="btn-icon">
                                <i class="fas fa-magic"></i>
                            </span>
                            <span class="btn-text">Generar Contenido</span>
                            <span class="btn-loading" style="display: none;">
                                <i class="fas fa-spinner fa-spin"></i>
                                Generando...
                            </span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Notificaciones Toast -->
    <div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 1055;">
        <div id="notification-toast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-body">
                <div class="notification-content">
                    <i class="notification-icon"></i>
                    <span class="notification-message"></span>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Elementos del DOM
    const contentTypeCards = document.querySelectorAll('.content-type-card');
    const contentTypeInput = document.getElementById('id_content_type');
    const uploadArea = document.getElementById('upload-area');
    const uploadInput = document.querySelector('.upload-input');
    const instructionsTextarea = document.querySelector('.instructions-textarea');
    const charCount = document.getElementById('char-count');
    const suggestionTags = document.querySelectorAll('.suggestion-tag');
    const generateBtn = document.getElementById('generate-btn');
    const form = document.querySelector('form');

    // Inicializar selección de tipo de contenido
    initContentTypeSelection();
    
    // Inicializar upload de archivos
    initFileUpload();
    
    // Inicializar contador de caracteres
    initCharacterCounter();
    
    // Inicializar sugerencias
    initSuggestions();
    
    // Inicializar envío del formulario
    initFormSubmission();

    function initContentTypeSelection() {
        // Marcar la opción seleccionada inicialmente
        const currentValue = contentTypeInput.value;
        if (currentValue) {
            const selectedCard = document.querySelector(`[data-value="${currentValue}"]`);
            if (selectedCard) {
                selectedCard.classList.add('selected');
            }
        }

        // Manejar clics en las tarjetas
        contentTypeCards.forEach(card => {
            card.addEventListener('click', function() {
                // Remover selección anterior
                contentTypeCards.forEach(c => c.classList.remove('selected'));
                
                // Seleccionar nueva tarjeta
                this.classList.add('selected');
                
                // Actualizar valor del input oculto
                const value = this.getAttribute('data-value');
                contentTypeInput.value = value;
                
                // Animación de feedback
                this.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    this.style.transform = '';
                }, 150);
            });
        });
    }

    function initFileUpload() {
        if (!uploadArea || !uploadInput) return;

        // Prevenir comportamiento por defecto del drag & drop
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            uploadArea.addEventListener(eventName, preventDefaults, false);
            document.body.addEventListener(eventName, preventDefaults, false);
        });

        // Resaltar área de drop
        ['dragenter', 'dragover'].forEach(eventName => {
            uploadArea.addEventListener(eventName, highlight, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            uploadArea.addEventListener(eventName, unhighlight, false);
        });

        // Manejar drop
        uploadArea.addEventListener('drop', handleDrop, false);

        // Manejar clic para seleccionar archivo
        uploadArea.addEventListener('click', () => uploadInput.click());

        // Manejar selección de archivo
        uploadInput.addEventListener('change', handleFileSelect);

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        function highlight() {
            uploadArea.classList.add('dragover');
        }

        function unhighlight() {
            uploadArea.classList.remove('dragover');
        }

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            handleFiles(files);
        }

        function handleFileSelect(e) {
            const files = e.target.files;
            handleFiles(files);
        }

        function handleFiles(files) {
            if (files.length > 0) {
                const file = files[0];
                if (file.type === 'application/pdf') {
                    updateUploadUI(file);
                } else {
                    showNotification('Por favor selecciona un archivo PDF válido.', 'error');
                }
            }
        }

        function updateUploadUI(file) {
            const uploadTitle = uploadArea.querySelector('.upload-title');
            const uploadSubtitle = uploadArea.querySelector('.upload-subtitle');
            const uploadIcon = uploadArea.querySelector('.upload-icon i');
            
            uploadIcon.className = 'fas fa-file-pdf';
            uploadTitle.textContent = file.name;
            uploadSubtitle.textContent = `${(file.size / 1024 / 1024).toFixed(2)} MB`;
            
            uploadArea.style.borderColor = 'var(--success-color)';
            uploadArea.style.background = 'rgba(16, 185, 129, 0.1)';
            
            showNotification('Archivo PDF cargado correctamente.', 'success');
        }
    }

    function initCharacterCounter() {
        if (!instructionsTextarea || !charCount) return;

        function updateCounter() {
            const length = instructionsTextarea.value.length;
            charCount.textContent = length;
            
            if (length > 800) {
                charCount.style.color = 'var(--warning-color)';
            } else if (length > 950) {
                charCount.style.color = 'var(--danger-color)';
            } else {
                charCount.style.color = 'var(--text-muted)';
            }
        }

        instructionsTextarea.addEventListener('input', updateCounter);
        updateCounter(); // Inicializar contador
    }

    function initSuggestions() {
        suggestionTags.forEach(tag => {
            tag.addEventListener('click', function() {
                const text = this.getAttribute('data-text');
                const currentValue = instructionsTextarea.value;
                const newValue = currentValue ? `${currentValue}\n\n${text}` : text;
                
                instructionsTextarea.value = newValue;
                instructionsTextarea.focus();
                
                // Actualizar contador
                if (charCount) {
                    charCount.textContent = newValue.length;
                }
                
                // Animación de feedback
                this.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    this.style.transform = '';
                }, 150);
                
                showNotification('Sugerencia añadida a las instrucciones.', 'success');
            });
        });
    }

    function initFormSubmission() {
        if (!form || !generateBtn) return;

        form.addEventListener('submit', function(e) {
            // Validar que se haya seleccionado un tipo de contenido
            if (!contentTypeInput.value) {
                e.preventDefault();
                showNotification('Por favor selecciona un tipo de contenido.', 'error');
                return;
            }

            // Mostrar estado de carga
            const btnText = generateBtn.querySelector('.btn-text');
            const btnLoading = generateBtn.querySelector('.btn-loading');
            
            btnText.style.display = 'none';
            btnLoading.style.display = 'inline-flex';
            generateBtn.disabled = true;
            
            showNotification('Iniciando generación de contenido...', 'info');
        });
    }

    function showNotification(message, type = 'info') {
        const toast = document.getElementById('notification-toast');
        const icon = toast.querySelector('.notification-icon');
        const messageEl = toast.querySelector('.notification-message');
        
        // Configurar icono según el tipo
        const icons = {
            success: 'fas fa-check-circle text-success',
            error: 'fas fa-exclamation-circle text-danger',
            warning: 'fas fa-exclamation-triangle text-warning',
            info: 'fas fa-info-circle text-info'
        };
        
        icon.className = icons[type] || icons.info;
        messageEl.textContent = message;
        
        // Mostrar toast
        const bsToast = new bootstrap.Toast(toast);
        bsToast.show();
    }

    // Función para asignar al portafolio (mantenida para compatibilidad)
    window.assignToPortfolio = function(materialId, materialType) {
        const url = materialType === 'class' ? 
            `/ai/contents/${materialId}/assign-class/` : 
            `/ai/contents/${materialId}/assign/`;
        
        fetch(url, {
            method: 'POST',
            headers: {
                'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value,
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                material_type: materialType
            })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                showNotification(data.message, 'success');
                // Opcional: recargar la página o actualizar la UI
                setTimeout(() => {
                    window.location.reload();
                }, 1500);
            } else {
                showNotification(data.message || 'Error al asignar el material', 'error');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            showNotification('Error de conexión al asignar el material', 'error');
        });
    };
});
</script>
{% endblock %}

{% block extra_css %}
<style>
:root {
    --primary-color: #005CFF;
    --primary-light: rgba(0, 92, 255, 0.1);
    --secondary-color: #A142F5;
    --accent-color: #8B5CF6;
    --success-color: #10B981;
    --warning-color: #F59E0B;
    --danger-color: #EF4444;
    --info-color: #005CFF;
    --text-primary: #1f2937;
    --text-secondary: #6b7280;
    --text-muted: #9ca3af;
    --border-color: #e5e7eb;
    --bg-light: #f8f9fa;
    --light-gray: #f8f9fa;
    --medium-gray: #e9ecef;
    --dark-gray: #495057;
    --card-shadow: 0 4px 12px rgba(0,0,0,0.05);
    --hover-shadow: 0 8px 25px rgba(0,0,0,0.1);
    --border-radius: 12px;
    --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
}

.modern-form-container {
    background: white;
    border-radius: var(--border-radius);
    box-shadow: var(--card-shadow);
    overflow: hidden;
    margin-bottom: 2rem;
    transition: var(--transition);
}

.modern-form-container:hover {
    box-shadow: var(--hover-shadow);
}

.form-header {
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
    padding: 2rem;
    display: flex;
    align-items: center;
    gap: 1rem;
    position: relative;
    overflow: hidden;
}

.form-header::before {
    content: '';
    position: absolute;
    top: 0;
    right: 0;
    width: 300px;
    height: 300px;
    background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
    border-radius: 50%;
    transform: translate(150px, -150px);
}

.header-icon {
    width: 60px;
    height: 60px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    color: white;
}

.header-content {
    flex: 1;
}

.header-title {
    color: white;
    margin: 0 0 0.5rem 0;
    font-size: 1.5rem;
    font-weight: 600;
}

.header-subtitle {
    color: rgba(255, 255, 255, 0.8);
    margin: 0;
    font-size: 1rem;
}

.form-body {
    padding: 2rem;
}

.form-section {
    margin-bottom: 2rem;
}

.section-title {
    color: var(--text-primary);
    font-size: 1.125rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
    display: flex;
    align-items: center;
}

.section-description {
    color: var(--text-secondary);
    font-size: 0.875rem;
    margin-bottom: 1.5rem;
}

.content-type-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 1rem;
    margin-bottom: 1rem;
}

.content-type-card {
    border: 2px solid var(--border-color);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    cursor: pointer;
    transition: var(--transition);
    background: white;
    display: flex;
    align-items: center;
    gap: 1rem;
    box-shadow: var(--card-shadow);
}

.content-type-card:hover {
    border-color: var(--primary-color);
    box-shadow: var(--hover-shadow);
    transform: translateY(-2px);
}

.content-type-card.selected {
    border-color: var(--primary-color);
    background: var(--primary-light);
    box-shadow: var(--hover-shadow);
}

.card-icon {
    width: 48px;
    height: 48px;
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.25rem;
    flex-shrink: 0;
}

.card-content {
    flex: 1;
}

.card-title {
    color: var(--text-primary);
    font-weight: 600;
    margin: 0 0 0.25rem 0;
    font-size: 1rem;
}

.card-description {
    color: var(--text-secondary);
    font-size: 0.875rem;
    margin: 0;
    line-height: 1.4;
}

.upload-area {
    border: 2px dashed var(--border-color);
    border-radius: var(--border-radius);
    padding: 3rem 2rem;
    text-align: center;
    cursor: pointer;
    transition: var(--transition);
    background: var(--bg-light);
    box-shadow: var(--card-shadow);
}

.upload-area:hover {
    border-color: var(--primary-color);
    background: var(--primary-light);
}

.upload-area.dragover {
    border-color: var(--primary-color);
    background: var(--primary-light);
    transform: scale(1.02);
}

.upload-icon {
    font-size: 3rem;
    color: var(--text-muted);
    margin-bottom: 1rem;
}

.upload-title {
    color: var(--text-primary);
    font-weight: 600;
    margin: 0 0 0.5rem 0;
}

.upload-subtitle {
    color: var(--text-secondary);
    margin: 0 0 0.5rem 0;
}

.upload-note {
    color: var(--text-muted);
    font-size: 0.75rem;
}

.instructions-container {
    position: relative;
}

.instructions-textarea {
    width: 100%;
    min-height: 120px;
    padding: 1rem;
    border: 2px solid var(--border-color);
    border-radius: var(--border-radius);
    font-size: 0.875rem;
    line-height: 1.5;
    resize: vertical;
    transition: var(--transition);
    font-family: inherit;
    box-shadow: var(--card-shadow);
}

.instructions-textarea:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px var(--primary-light);
}

.char-counter {
    position: absolute;
    bottom: 0.75rem;
    right: 1rem;
    font-size: 0.75rem;
    color: var(--text-muted);
    background: white;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    box-shadow: var(--shadow-sm);
}

.suggestions-section {
    margin-top: 1rem;
}

.suggestions-title {
    color: var(--text-primary);
    font-size: 0.875rem;
    font-weight: 600;
    margin-bottom: 0.75rem;
}

.suggestions-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
}

.suggestion-tag {
    background: var(--bg-light);
    border: 1px solid var(--border-color);
    border-radius: 20px;
    padding: 0.5rem 1rem;
    font-size: 0.75rem;
    color: var(--text-secondary);
    cursor: pointer;
    transition: var(--transition);
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    box-shadow: var(--card-shadow);
}

.suggestion-tag:hover {
    background: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
    transform: translateY(-1px);
    box-shadow: var(--hover-shadow);
}

.form-actions {
    text-align: center;
    padding-top: 2rem;
    border-top: 1px solid var(--border-color);
}

.generate-btn {
    background: var(--primary-color);
    color: white;
    border: none;
    border-radius: 8px;
    padding: 1rem 2rem;
    font-size: 1rem;
    font-weight: 500;
    cursor: pointer;
    transition: var(--transition);
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    min-width: 200px;
    justify-content: center;
    box-shadow: var(--card-shadow);
}

.generate-btn:hover:not(:disabled) {
    background: #0052e6;
    transform: translateY(-2px);
    box-shadow: var(--hover-shadow);
}

.generate-btn:disabled {
    opacity: 0.7;
    cursor: not-allowed;
}

.btn-loading {
    display: none;
    align-items: center;
    gap: 0.5rem;
}

.notification-content {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: 0.875rem;
    font-weight: 500;
}

/* Responsive Design */
@media (max-width: 768px) {
    .form-header {
        padding: 1.5rem;
        flex-direction: column;
        text-align: center;
    }
    
    .form-body {
        padding: 1.5rem;
    }
    
    .content-type-grid {
        grid-template-columns: 1fr;
    }
    
    .content-type-card {
        padding: 1rem;
    }
    
    .upload-area {
        padding: 2rem 1rem;
    }
    
    .suggestions-tags {
        justify-content: center;
    }
}

/* Animaciones */
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.modern-form-container {
    animation: fadeInUp 0.6s ease-out;
}

.content-type-card {
    animation: fadeInUp 0.6s ease-out;
}

.content-type-card:nth-child(1) { animation-delay: 0.1s; }
.content-type-card:nth-child(2) { animation-delay: 0.2s; }
.content-type-card:nth-child(3) { animation-delay: 0.3s; }
.content-type-card:nth-child(4) { animation-delay: 0.4s; }
.content-type-card:nth-child(5) { animation-delay: 0.5s; }
.content-type-card:nth-child(6) { animation-delay: 0.6s; }
</style>
{% endblock %} 